{% extends "cms/base.html" %}
{% load cms_tags couchdb similar_species %}

{% block scripts %}
{{ block.super }}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"
        type="text/javascript"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jquery.jcarousel.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jquery.jqplot.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jqplot.barRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jqplot.canvasTextRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jqplot.canvasAxisLabelRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js/jqplot.categoryAxisRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}colorbox/jquery.colorbox-min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}slideshow/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}map/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}chart/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}data/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}similar_species/script.js"></script>

<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAACGFOAg3wAbbVTv66SFVQQxSYHLM1a-x6NXPXd7iQMKLtQ16USxRXBoJwXZQrS0JinK9yxAv9Gqry_g&sensor=false" type="text/javascript"></script>
<script src="http://gmaps-utility-library.googlecode.com/svn/trunk/markermanager/release/src/markermanager.js" type="text/javascript"></script>
{% endblock %}

{% block stylesheets %}
{{ block.super }}
<link rel="stylesheet" href="{{ MEDIA_URL }}css/jquery.jqplot.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}colorbox/colorbox.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}slideshow/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}map/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}chart/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}data/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}similar_species/style.css" type="text/css">
{% endblock %}

{% block content %}
<!-- wikipage start -->
<h1>{% page_attribute page_title %}</h1>

<div class="factsheet yui-g">
    <div class="yui-u first all-images all-images-no-js">
        <div id="images">
            {% couchdb /pnwmoths/_design/moths/_list/full_images/by_labelled_species_image?image_url=http://pnwmoths.biol.wwu.edu&first_image=true&startkey=["%(key)s","A"]&endkey=["%(key)s","Z"] key=current_page.get_title %}
        </div>

        {% similar_species %}
    </div>
    <div class="yui-u">
        <div id="googlemap" class="googlemap">
            <span class="data">"species-data"</span>
            <div id="filters">
                <p class="right"><a href="" id="filters-close"><img src="http://maps.gstatic.com/intl/en_us/mapfiles/iw_close.gif" /></a></p>
                <p>
                    <form>
                        <input type="button" id="clear-filters" value="Clear filters" />
                        <input type="button" id="toggle-borders" value="Toggle borders" />
                    </form>
                </p>
            </div>
        </div>
        <div id="plot" class="chart tab">
            <span class="data">species-data</span>
            <span class="options"></span>
        </div>
    </div>
</div>

{% placeholder "factsheet" %}

<!-- wikipage stop -->

<!-- data start -->
<span class="dokuwiki-data" id="species-data">
{% couchdb /pnwmoths/_design/moths/_list/json_collection_doc/by_species?include_docs=true&key="%(key)s" key=current_page.get_title %}
</span>
<span class="dokuwiki-data" id="state-data">
{% couchdb /pnwmoths/_design/moths/_list/json_keys/states?group=true&reduce=true %}
</span>
<span class="dokuwiki-data" id="county-data">
{% couchdb /pnwmoths/_design/moths/_list/json_keys/counties?group=true&reduce=true %}
</span>
<span class="dokuwiki-data" id="collection-data">
{% couchdb /pnwmoths/_design/moths/_list/json_keys/by_collection?group=true&reduce=true %}
</span>
<!-- data stop -->
{% endblock %}
