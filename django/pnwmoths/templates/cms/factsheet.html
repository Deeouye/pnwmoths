{% extends "cms/base.html" %}
{% load factsheet_filters cache cms_tags species_tags thumbnail %}

{% block scripts %}
{{ block.super }}
<!--[if lt IE 9]><script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/excanvas.min.js"></script><![endif]-->
<script language="javascript" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.js"></script>

<script type="text/javascript" src="{{ MEDIA_URL }}zoomify/ZoomifyImageViewer.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}zoomify/sizeViewerToPage.js"></script>

<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.jqplot.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jqplot.barRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jqplot.canvasTextRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jqplot.canvasAxisLabelRenderer.min.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jqplot.categoryAxisRenderer.min.js"></script>

<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.colorbox-min.js"></script>

<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.multiselect.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.multiselect.filter.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.rangeslider.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.daterangeslider.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.editrangeslider.js"></script>

<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.tipTip.minified.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}js_ext/jquery.elastislide.js"></script>


<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}js_ext/FastMarkerOverlay.js " type="text/javascript"></script>
<script src="{{ MEDIA_URL }}js_ext/infobubble.js" type="text/javascript"></script>

<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}fs_map/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}fs_chart/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}fs_similar_species/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}fs_slideshow/script.js"></script>
<script language="javascript" type="text/javascript" src="{{ MEDIA_URL }}data/script.js"></script>
{% endblock %}

{% block stylesheets %}
{{ block.super }}
<link rel="stylesheet" href="{{ MEDIA_URL }}css_ext/elastislide.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}css_ext/jquery.jqplot.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}css_ext/jquery.tipTip.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}css_ext/colorbox.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}fs_map/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}fs_chart/style.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}data/style.css" type="text/css">
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/redmond/jquery-ui.css" type="text/css">
<link rel="stylesheet" href="{{ MEDIA_URL }}css_pages/factsheet.css" type="text/css">
{% endblock %}

{% block content %}
<!-- wikipage start -->
{% species_by_name current_page.get_title as species %}
<div class="row top">
    <div class="twelvecol last">
        <h2 style="display: inline" class="fs_title"><em>{{ species.name }}</em> {% if species.authority %}{{ species.authority }}{% endif %}</h2>
        {% if species.noc_id %}<h3 style="float: right; margin-right: 10px; color: grey">{{ species.noc_id }}</h3>{% endif %}
        {% if species.common_name %}<h3 style="clear: both" class="fs_title">{{ species.common_name }}</h3>{% endif %}
    </div>
</div>
<div id="fs_yui-g" class="row bottom">
<div class="twelvecol last">
    <div id="fs_images">
        <div class="all-images all-images-no-js">
            <div id="images">
                {% for species_image in species.speciesimage_set.all %}
                    {% if forloop.first %}
                        <div class="current-image">
                        {% thumbnail species_image.image species_image.SIZES.medium as im %}
                            <div id="old-image-factsheet" class="hidden"><a href="{{ species_image.image.url }}"><img src="{{ im.url }}" /></a></div>
                            <div id="zoomify-factsheet" class="hidden"></div>
                            <div id="slideshow-copyright">
                                    {{ species_image.specimen_details|safe }}
                                    {{ species_image.license_details|safe }}
                            </div>
                        {% endthumbnail %}
                        </div>
                        <div id="carousel-other-images" class="es-carousel-wrapper">
                        <div class="es-carousel">
                        <ul class="other-images">
                    {% endif %}
                    <li>
                    {% cache 0 species_thumb forloop.counter species.name %}
                        {% thumbnail species_image.image species_image.SIZES.medium as medium %}
                        {% thumbnail species_image.image species_image.SIZES.thumbnail as small %}
                            <a href="{{ species_image.image.url }}" title='{{ species_image.specimen_details }}{{ species_image.license_details }}&nbsp;' class="thumbnail">
                                <img src="{{ small.url }}" />
                            </a>
                            {% with species_image.zoomify_folder|safe as inline_species_image %}
                                {% ifequal inline_species_image "404" %}
                                    <span class="hidden inline-species-image missing_zoomify">{{ medium.url }}</span>
                                {% else %}
                                    <span class="hidden inline-species-image">{{ MEDIA_URL }}{{ inline_species_image }}</span>
                                {% endifequal %}
                            {% endwith %}
                        {% endthumbnail %}
                        {% endthumbnail %}
                    {% endcache %}
                    </li>
                    {% if forloop.last %}
                        </ul></div></div>
                    {% endif %}
                {% endfor %}
            </div>

        {% if species.similar.all or request.user.is_staff %}
            <div id="similar">
            <h2>
                Similar Species
                {% if request.user.is_staff and species %}
                    <span class="edit"><a href="{% url admin:species_species_change species.id %}" target="_new">edit</a></span>
                {% endif %}
            </h2>
            <div id="carousel-similarspecies-images" class="es-carousel-wrapper">
            <div class="es-carousel">
            <ul class="other-images">
            {% for similar_species in species.similar.all %}
                <li>
                {% cache 0 sim_link similar_species.name %}
                    <a href="{% page_url similar_species.factsheet %}" target="_blank">
                    {% with similar_species.get_first_image as similar_image %}
                        {% thumbnail similar_image.image similar_image.SIZES.thumbnail as im %}
                            <img src="{{ im.url }}" title="{{ similar_image.title }}" /><br />
                        {% endthumbnail %}
                    {% endwith %}
                    {{ similar_species }}
                    </a>
                {% endcache %}
                </li>
            {% endfor %}
            </ul>
            </div>
            </div>
          </div>
      {% endif %}
      </div>
    </div>
    <div id="map_phen_filter_col"> 
        <div id="googlemap" class="googlemap">
            <span class="data">"species-data"</span>
        </div>
        <div id="plot" class="chart tab">
            <span class="data">species-data</span>
            <span class="options"></span>
        </div>
        <div id="factsheet-filters">
            <h4>Data Filters</h4>
            <select class="third" id="f-county" multiple="multiple">        
            </select>
            <select class="third" id="f-state" multiple="multiple">        
            </select>
            <select class="third" id="f-collection" multiple="multiple">        
            </select>
            <select class="third" id="f-year" multiple="multiple"><option value="2012">2012</option><option value="2011">2011</option><option value="2010">2010</option><option value="2009">2009</option><option value="2008">2008</option><option value="2007">2007</option><option value="2006">2006</option><option value="2005">2005</option><option value="2004">2004</option><option value="2003">2003</option><option value="2002">2002</option><option value="2001">2001</option><option value="2000">2000</option><option value="1999">1999</option><option value="1998">1998</option><option value="1997">1997</option><option value="1996">1996</option><option value="1995">1995</option><option value="1994">1994</option><option value="1993">1993</option><option value="1992">1992</option><option value="1991">1991</option><option value="1990">1990</option><option value="1989">1989</option><option value="1988">1988</option><option value="1987">1987</option><option value="1986">1986</option><option value="1985">1985</option><option value="1984">1984</option><option value="1983">1983</option><option value="1982">1982</option><option value="1981">1981</option><option value="1980">1980</option><option value="1979">1979</option><option value="1978">1978</option><option value="1977">1977</option><option value="1976">1976</option><option value="1975">1975</option><option value="1974">1974</option><option value="1973">1973</option><option value="1972">1972</option><option value="1971">1971</option><option value="1970">1970</option><option value="1969">1969</option><option value="1968">1968</option><option value="1967">1967</option><option value="1966">1966</option><option value="1965">1965</option><option value="1964">1964</option><option value="1963">1963</option><option value="1962">1962</option><option value="1961">1961</option><option value="1960">1960</option><option value="1959">1959</option><option value="1958">1958</option><option value="1957">1957</option><option value="1956">1956</option><option value="1955">1955</option><option value="1954">1954</option><option value="1953">1953</option><option value="1952">1952</option><option value="1951">1951</option><option value="1950">1950</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option><option value="1929">1929</option><option value="1928">1928</option><option value="1927">1927</option><option value="1926">1926</option><option value="1925">1925</option><option value="1924">1924</option><option value="1923">1923</option><option value="1922">1922</option><option value="1921">1921</option><option value="1920">1920</option><option value="1919">1919</option><option value="1918">1918</option><option value="1917">1917</option><option value="1916">1916</option><option value="1915">1915</option><option value="1914">1914</option><option value="1913">1913</option><option value="1912">1912</option><option value="1911">1911</option><option value="1910">1910</option><option value="1909">1909</option><option value="1908">1908</option><option value="1907">1907</option><option value="1906">1906</option><option value="1905">1905</option><option value="1904">1904</option><option value="1903">1903</option><option value="1902">1902</option><option value="1901">1901</option><option value="1900">1900</option></select>
            <select class="third" id="f-month" multiple="multiple"><option value='01'>January</option><option value='02'>February</option><option value='03'>March</option><option value='04'>April</option><option value='05'>May</option><option value='06'>June</option><option value='07'>July</option><option value='08'>August</option><option value='09'>September</option><option value='10'>October</option><option value='11'>November</option><option value='12'>December</option></select>
            <select class="third" id="f-day" multiple="multiple"><option value='01'>01</option><option value='02'>02</option><option value='03'>03</option><option value='04'>04</option><option value='05'>05</option><option value='06'>06</option><option value='07'>07</option><option value='08'>08</option><option value='09'>09</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='13'>13</option><option value='14'>14</option><option value='15'>15</option><option value='16'>16</option><option value='17'>17</option><option value='18'>18</option><option value='19'>19</option><option value='20'>20</option><option value='21'>21</option><option value='22'>22</option><option value='23'>23</option><option value='24'>24</option><option value='25'>25</option><option value='26'>26</option><option value='27'>27</option><option value='28'>28</option><option value='29'>29</option><option value='30'>30</option><option value='31'>31</option></select>
            <div id="date-filter-1" class="whole" style="padding-top: 50px">
                    <div id="f-date"></div>
            </div>
            <h6 style="color: grey; margin-left: 30px">Date Range</h6>
            <div id="datefilterdialog">
            </div>
            <div class="whole" style="margin-top: 60px">
                <div id="f-elevation"></div>
            </div>
            <h6 style="color: grey; margin-left: 30px">Elevation (ft)</h6>
            <div class="third" style="margin-top: 15px; float: right;">
                <input id="f-reset" type="submit" value="Reset Filters" >
            </div>
        </div>
    </div>
    <div id="fs_content">
        {% placeholder "factsheet" %}
    </div>
</div>

<!-- data start -->
{% if species %}
    {% cache 0 js_data species.name %}
    <span class="dokuwiki-data" id="species-data">
    {{ species|get_records|safe }}
    </span>
    <span class="dokuwiki-data" id="state-data">
    {{ species|filters_json:"state__code"|safe }}
    </span>
    <span class="dokuwiki-data" id="county-data">
    {{ species|filters_json:"county"|safe }}
    </span>
    <span class="dokuwiki-data" id="collection-data">
    {{ species|filters_json:"collection__name"|safe }}
    </span>
    {% endcache %}
{% endif %}
<!-- data stop -->
</div>
{% endblock %}
